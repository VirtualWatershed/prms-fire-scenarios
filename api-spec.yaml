---
swagger: '2.0'
info:
    version: "0.0.1"
    title: PRMS Fire Scenarios
    description: |
        This API will serve as the backbone of PRMS fire scenario modeling. 
        The immediate use will be in a web browser and Unity apps. However this
        will enable the PRMS tool to be used in any client that can make HTTP
        calls.

#host: virtualwatershed.org
host: "localhost:5000"
basePath: /api

schemes:
    - http
    - https
consumes:
    - application/json
produces:
    - application/json

tags:
- name: scenarios


paths:

    #############
    # Scenarios #
    #############
    /base-veg-map:
        get:
            summary: get the base map used to generate initial view of landscape
            tags:
                - scenarios
            operationId: getBaseVegetationMap

            responses:
                200:
                    description: "successful operation"

    /scenarios:
        get:
            summary: list all scenarios
            tags:
                - scenarios
            operationId: listCompletedScenarios

            responses:
                200:
                    description: "successful operation"
                    schema:
                        type: "array"
                        items:
                            $ref: "#/definitions/Scenario"

        post:
            summary: request a new scenario
            tags: 
                - scenarios
            operationId: runNewScenario

            parameters:
                - name: fire_geometry
                  type: object
                  in: body
                  description: 
                      <a href="http://geojson.org/geojson-spec.html#id7">GeoJSON 
                      Multipolygon</a> of the fire area(s)</a>
                  schema:
                      type:
                          $ref: 'http://geojson.org/geojson-spec.html#id7'

            responses:
                200:
                    description: "successful operation"
                    schema:
                        $ref: "#/definitions/Scenario" 

    /scenarios/{scenarioId}:
        get:
            summary: lookup a scenario by its id
            tags:
                - scenarios
            operationId: getScenario

            parameters:
                - name: scenarioId
                  in: path
                  required: true
                  type: string


            responses:
                200:
                    description: "successful operation"
                    schema:
                        $ref: "#/definitions/Scenario" 

        put:
            summary: lookup a scenario by its id
            tags:
                - scenarios
            operationId: getScenario

            parameters:
                - name: scenarioId
                  in: path
                  required: true
                  type: string

                - name: name
                  in: body
                  required: false
                  type: string
                  description: update scenario name

            responses:
                200:
                    description: "successful operation"
                    schema:
                        $ref: "#/definitions/Scenario" 

        delete:
            summary: remove a scenario by its id
            tags:
                - scenarios
            operationId: deleteScenario

            parameters:
                - name: scenarioId
                  in: path
                  required: true
                  type: string


            responses:
                200:
                    description: "successful operation"


###################
#   DEFINITIONS   #
###################
# 
#
definitions:

    Scenario:

        type: object
        properties:
            name:
                type: string
                description: scenario name, to be used as description as well
            id:
                type: string
                description: server-generated id for scenario
            time_received:
                type: string
                format: date-time
                description: auto-generated by server when scenario request received
            time_finished:
                type: string
                format: date-time
                description: auto-generated by server when scenario model has finished
            fire_geometry:
                type: object
                description:
                    <a href="http://geojson.org/geojson-spec.html#id7">GeoJSON 
                    Multipolygon</a> of the fire area(s)
                schema:
                    type:
                        $ref: 'http://geojson.org/geojson-spec.html#id7'
            total_fire_area:
                type: float
                description:
                    total calculated area of the fire_geometry 
                    <a href="http://geojson.org/geojson-spec.html#id7">GeoJSON 
                    Multipolygon</a> of the fire area(s)
            inputs:
                type: object
                description: download links to control, data, and parameter files for scenario
                schema:
                    type:
                        $ref: "#/definitions/Input"
            outputs:
                type: object
                description: download links to PRMS output files for scenario
                schema:
                    type:
                        $ref: "#/definitions/Output"
            hydrograph:
                type: object
                description:
                    keys of this object are datetimes, values are streamflow rates
                    in cubic feet per second (cfs)

    Input:
        type: object
        properties:
            control:
                type: string
                description: download link to control file used in scenario
            parameter:
                type: string
                description: download link to parameter file used in scenario
            data:
                type: string
                description: download link to data file used in scenario

    Output:
        type: object
        description: download links to PRMS output files
        properties:
            file1: string
            description: yo
